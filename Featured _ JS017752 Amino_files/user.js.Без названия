(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{105:function(t,e,o){"use strict";function n(t,e){try{return sessionStorage.setItem(t,JSON.stringify(e))}catch(t){}}function i(t){try{return JSON.parse(sessionStorage.getItem(t))}catch(t){}}function r(t){try{return sessionStorage.removeItem(t)}catch(t){}}o.d(e,"c",function(){return n}),o.d(e,"a",function(){return i}),o.d(e,"b",function(){return r})},30:function(t,e,o){"use strict";o.d(e,"b",function(){return a}),o.d(e,"d",function(){return s}),o.d(e,"a",function(){return c}),o.d(e,"c",function(){return l});var n,i=function(){function t(t,e){void 0===t&&(t="keyval-store"),void 0===e&&(e="keyval"),this.storeName=e,this._dbp=new Promise(function(o,n){var i=indexedDB.open(t,1);i.onerror=function(){return n(i.error)},i.onsuccess=function(){return o(i.result)},i.onupgradeneeded=function(){i.result.createObjectStore(e)}})}return t.prototype._withIDBStore=function(t,e){var o=this;return this._dbp.then(function(n){return new Promise(function(i,r){var a=n.transaction(o.storeName,t);a.oncomplete=function(){return i()},a.onabort=a.onerror=function(){return r(a.error)},e(a.objectStore(o.storeName))})})},t}();function r(){return n||(n=new i),n}function a(t,e){var o;return void 0===e&&(e=r()),e._withIDBStore("readonly",function(e){o=e.get(t)}).then(function(){return o.result})}function s(t,e,o){return void 0===o&&(o=r()),o._withIDBStore("readwrite",function(o){o.put(e,t)})}function c(t,e){return void 0===e&&(e=r()),e._withIDBStore("readwrite",function(e){e.delete(t)})}function l(t){void 0===t&&(t=r());var e=[];return t._withIDBStore("readonly",function(t){(t.openKeyCursor||t.openCursor).call(t).onsuccess=function(){this.result&&(e.push(this.result.key),this.result.continue())}}).then(function(){return e})}},328:function(t,e,o){"use strict";o.r(e);var n=o(19),i=(o(398),o(345)),r=o(338),a=ServerData&&ServerData.community&&ServerData.community.ndcId.replace("x",""),s="web-user-active-time-last-report";var c=n.VComponent.loader;n.VComponent.loader=function(t){return/^user\//.test(t)?(t=t.substr(5),o(396)("./"+t).default):c(t)},ServerData.accountId&&Object(i.a)(),function(){if(a)try{var t=+localStorage.getItem(s),e=Date.now();(!t||e-t>6e5)&&(Object(r.g)(a),localStorage.setItem(s,String(e)))}catch(t){}}()},338:function(t,e,o){"use strict";o.d(e,"d",function(){return i}),o.d(e,"h",function(){return r}),o.d(e,"j",function(){return a}),o.d(e,"c",function(){return s}),o.d(e,"i",function(){return c}),o.d(e,"b",function(){return l}),o.d(e,"a",function(){return u}),o.d(e,"g",function(){return d}),o.d(e,"f",function(){return h}),o.d(e,"e",function(){return p});var n=o(5);function i(){return Object(n.e)("/partial/global-identity")}function r(){return Object(n.h)("logout")}function a(t,e,o){return Object(n.h)("poll-option/"+t+"/"+e+"/"+o+"/vote")}function s(t,e){return Object(n.h)("/api/follow-user",{ndcId:t,followee_id:e})}function c(t,e,o){return Object(n.h)("/api/unfollow-user",{ndcId:t,followee_id:e,follower_id:o})}function l(t){var e=t.ndcId,o=t.uid;return Object(n.h)("find-exist-single-chat",{ndcId:e,uid:o}).catch(function(t){var e=t.response;if(!e||1600!==e.api_status_code)throw t;return{threadList:[]}})}function u(t){var e=t.ndcId,o=t.uid,i=t.initialMessageContent;return Object(n.h)("create-chat-thread",{ndcId:e,inviteeUids:[o],initialMessageContent:i,type:0})}function d(t){return Object(n.h)("community/stats/web-user-active-time",{ndcId:t})}function h(t){return Object(n.h)("leave",{ndcId:t})}function p(t){return Object(n.b)("get-user-profile",{ndcId:t})}},341:function(t,e,o){"use strict";o.d(e,"a",function(){return r}),o.d(e,"h",function(){return a}),o.d(e,"e",function(){return s}),o.d(e,"k",function(){return u}),o.d(e,"l",function(){return d}),o.d(e,"i",function(){return h}),o.d(e,"j",function(){return p}),o.d(e,"c",function(){return f}),o.d(e,"b",function(){return y}),o.d(e,"g",function(){return g}),o.d(e,"d",function(){return C}),o.d(e,"f",function(){return L});var n=o(32),i=o(9),r=new n.a;function a(t,e){var o=c();o&&o.contentWindow.postMessage({type:t,payload:e},location.origin)}function s(t){localStorage.removeItem("chat-window-close"),a("openChatWindow",t)}function c(){return document.querySelector(".chat-window-iframe")}var l=Promise.resolve();function u(t,e,o){void 0===o&&(o={forceReload:!1}),function(t){if(t===v&&!ServerData.isMember)return;localStorage.setItem("chat-window-ndc-id",t)}(t);var n,i=c();if(!i)return Promise.reject();if(r.emit("switchToCommunity",t),(i.src&&new URL(i.src).searchParams.get("ndcId"))===String(t)&&!o.forceReload)return l;l=new Promise(function(t){return n=t}),i.onload=function(){return setTimeout(n,1e3)},r.off("chatWindowLoaded"),r.on("chatWindowLoaded",n);var a="/partial/main-chat-window?ndcId="+t;if(e)for(var s in e)a+="&"+encodeURIComponent(s)+"="+encodeURIComponent(e[s]);return i.src=a,l}function d(t,e,o){var n=o.source,i=void 0===n?"":n,r=o.action,s=void 0===r?"":r;return u(t).then(function(){a("switchToThread",{threadId:e,source:i,action:s})})}function h(t){var e=t.ndcId,o=t.thread,n=t.source,i=t.action;u(e).then(function(){a("sendSingleChat",{thread:o,source:n,action:i})})}function p(){localStorage.setItem("chat-window-close","true")}function f(){return localStorage.getItem("chat-window-close")}var m,v=ServerData.community&&Object(i.b)(ServerData.community.ndcId);function y(){var t=localStorage.getItem("chat-window-ndc-id");return t&&/^\d+$/.test(t)?t:(p(),v||"")}function g(t){t===y()&&localStorage.removeItem("chat-window-ndc-id")}var b=!0,w=/narvii.com|pebkit.com/;function I(){a("endDragFile"),b=!0}function C(){try{return!!localStorage.getItem("chat-window-minimized")}catch(t){return!1}}function L(t){t?localStorage.setItem("chat-window-minimized","true"):localStorage.removeItem("chat-window-minimized")}document.body.addEventListener("dragstart",function(t){var e=t.dataTransfer.getData("text/uri-list");b=!(!w.test(e)||!/(jpg|jpeg|png|gif)$/.test(e))}),document.body.addEventListener("dragover",function(t){t.preventDefault(),clearTimeout(m),b&&a("startDragFile")}),document.body.addEventListener("dragleave",function(t){m=setTimeout(I,50)}),document.body.addEventListener("drop",function(t){t.preventDefault(),I()}),r.on("dragEnterWindow",function(){clearTimeout(m)}),r.on("dropInWindow",I),window.addEventListener("message",function(t){if(t.origin===location.origin){var e=t.data,o=e.type,n=e.payload;"chat"===e.identity&&r.emit(o,n)}})},342:function(t,e,o){"use strict";o.r(e),o.d(e,"removeCommunityFromHTMLCache",function(){return f}),o.d(e,"removeCommunityHTMLCache",function(){return m});var n=o(0),i=o(3),r=o(5),a=o(341),s=o(2),c=o(364);function l(t){return Object(r.h)("global-chat-communities",{ndcIds:t}).then(function(t){return t.reminderCheckResultInCommunities})}function u(t){for(var e={},o=0,n=t;o<n.length;o++)for(var i=n[o],r=0,a=Object.keys(i);r<a.length;r++){var s=a[r];e[s]=i[s]}return e}var d="GLOBAL_CHAT_COMMUNITY_ACTIVE",h=9;function p(t){for(var e=-1,o=v(),n=0,i=o.length;n<i;n++)if(o[n].ndcId===t){e=n;break}return e>=0&&o.splice(e,1),o}function f(t){var e=p(t);localStorage.setItem(d,JSON.stringify(e))}function m(){localStorage.removeItem(d)}function v(){try{return JSON.parse(localStorage.getItem(d))||[]}catch(t){return[]}}function y(t){for(var e=t.outerHTML,o=t.dataset.ndcId,n=v(),i=0,r=n.length;i<r;i++){var a=n[i];if(a.ndcId===o){a.html=e,localStorage.setItem(d,JSON.stringify(n));break}}}function g(t){var e=t.outerHTML,o=t.dataset.ndcId,n=p(o);return n.unshift({ndcId:o,html:e}),n=n.slice(0,h),localStorage.setItem(d,JSON.stringify(n)),n}var b=ServerData.community&&ServerData.community.ndcId.replace("x","");var w=document.defaultView.getComputedStyle,I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["click/.community-badge/focusCommunity","wheel/@root/onWheel","mouseover/.community-badge/displayName","mouseout/.community-badge/delayHideName"]},enumerable:!0,configurable:!0}),e.prototype.displayName=function(t){var e=t.currentTarget,o=e.getBoundingClientRect(),n=e.dataset.communityName,i=e.dataset.url,r=o.top+34,a=document.body.clientWidth-o.left+10;this.app.globalChatName.displayName({top:r,right:a,href:i,communityName:n,theme:"left",referType:"sidebar_community_label"})},e.prototype.delayHideName=function(t){this.app.globalChatName.delayHideName()},e.prototype.onWheel=function(t){if(!this.nativeDisableOverscroll){var e=-t.deltaY||-t.detail;this.scrollList.scrollTop+=40*(e<0?1:-1),t.preventDefault()}this.app.globalChatName.hideName();var o=this.qs(".current-community-badge");o&&o.classList.toggle("shadow-when-scroll",this.scrollList.scrollTop>20)},e.prototype.listenChatWindows=function(){var t=this;a.a.on("closeChatWindow",function(){t.removeActiveIndicators()}),a.a.on("threadAllRead",function(e){var o=t.findBadge(e);o&&o.classList.remove("unread")}),a.a.on("switchToCommunity",function(e){t.loaded?t.applyActiveStyle(e):t.ndcIdToLoad=e}),a.a.on("newMessageInNdc",function(e){var o=t.findBadge(e);o&&!o.classList.contains("active")&&o.classList.add("unread")}),a.a.on("sendNotification",function(e){t.sendNotification(e)})},e.prototype.init=function(){this.scrollList=this.qs(".chat-aminos");var t=w(this.scrollList);this.nativeDisableOverscroll=!!t.overscrollBehavior;var e=this.list=this.children.list[0],o=v().map(function(t){return t.ndcId});e.shouldIncludeItem=function(t){var e=-1!==o.indexOf(t.dataset.ndcId);return e&&y(t),!e},this.listenChatWindows(),this.loopCommunities()},e.prototype.applyActiveStyle=function(t){if(t){this.removeActiveIndicators();var e=this.findBadge(t);e&&e.classList.add("active"),(t!==b||ServerData.isMember)&&g(e)}},e.prototype.findBadge=function(t){return this.qs('[data-ndc-id="'+t+'"]')},e.prototype.removeActiveIndicators=function(){for(var t=this.qsa(".community-badge"),e=0,o=t.length;e<o;e++)t[e].classList.remove("active")},e.prototype.mountPartial=function(t){this.root.innerHTML+=t;var e,o,n=v().map(function(t){return t.ndcId}),i=this.qs(".aminos-list");return[].slice.call(i.querySelectorAll(".community-badge")).forEach(function(t){n.indexOf(t.dataset.ndcId)>=0&&(y(t),t.remove())}),i.insertBefore((e=v(),o=document.createDocumentFragment(),e.forEach(function(t){if(t.ndcId!==b){var e=Object(s.f)(t.html);e.classList.remove("unread","active"),o.appendChild(e)}}),o),i.childNodes[0]),this.loaded=!0,this.app.userChatWindow&&!Object(a.c)()&&this.applyActiveStyle(this.app.userChatWindow.currentNdcId),this.renderChildren()},e.prototype.bindDomEvents=function(){var e=this;this.loaded=!1;var o=b,n=Object(r.e)("/partial/global-chat-communities?ndcId="+o);return this.root.classList.remove("cloak"),n.then(function(t){return e.mountPartial(t)}).then(function(){return t.prototype.bindDomEvents.call(e)})},e.prototype.focusCommunity=function(t){var e=t.currentTarget;this.removeActiveIndicators();var o=e.dataset.ndcId;(o!==b||ServerData.isMember)&&g(e),e.classList.add("active");var n=this.app.userChatWindow;this.app.globalChatName.hideName(),n&&n.switchToCommunity(o,{source:"sidebar_community_list",action:"click"},{forceReload:!0})},e.prototype.loopCommunities=function(){var t=this;if(!this.loading){this.loading=!0;var e=[],o=this.qs(".current-community-badge");o&&e.push(o.dataset.ndcId);for(var n,i,r,a,s=this.qsa(".aminos-list .community-badge"),c=0,d=s.length;c<d;c++){var h=s[c],p=h.dataset.ndcId;n=h,i=this.scrollList,void 0,void 0,r=i.scrollTop,a=n.offsetTop,r+i.clientHeight>=a&&r<=a+n.clientHeight&&e.push(p)}0!==e.length&&function(t){for(var e=[],o=0;o<t.length;o+=10)e.push(t.slice(o,o+10));return Promise.all(e.map(l)).then(u)}(e).then(function(e){var o=function(t,e){for(var o=!1,n=0,i=t.length;n<i;n++){var r=t[n],a=r.dataset.ndcId;if(e[a]&&!r.classList.contains("active")){var s=e[a];s.unreadChatThreadsCount>0?(o=o||!r.classList.contains("unread"),r.classList.add("unread")):r.classList.remove("unread")}}return o}(s,e);t.loading=!1,setTimeout(function(){t.loopCommunities()},o?1e4:3e4)})}},e.prototype.sendNotification=function(t){var e=this;if(t.aps.sound){var o=this.findBadge(t.ndcId),n="/static/img/master-icon-72@2x.png",i="Amino";if(o)n=o.querySelector("img").src,i=o.dataset.communityName;else if(!this.list.shouldEndWatcher())return void this.list.loadNext().then(function(){e.sendNotification(t)});var r=Object(c.d)(i,{body:t.aps.alert,icon:n,badge:n,data:t});return r&&(r.onclick=function(t,e){return function(){t.switchToThread(e.tid,{source:"notification",action:"click",ndcId:e.ndcId}),window.focus(),this.close()}}(this.app.userChatWindow,t)),r}},e}(i.a);e.default=I},345:function(t,e,o){"use strict";o.d(e,"a",function(){return r});var n=o(5),i=o(10);function r(){var t=new i.a({key:"global-block-"+ServerData.accountId,expire:18e5}),e=t.get();return e?Promise.resolve(e):Object(n.b)("block/full-list").then(function(e){var o=e.blockerUidList,n={blockedUidList:e.blockedUidList,blockerUidList:o};return t.set(n),window.globalInjectBlockStyle&&window.globalInjectBlockStyle(),n})}},349:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(338),a=o(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),e.prototype.init=function(){for(var t={},e=this.qsa(".poll-item"),o=0,n=e.length;o<n;o++){var i=e[o].dataset,r=i.polloptId,a=i.polloptNum;t[r]=parseInt(a,10)}var s=this.qs(".poll-item.voted-item");this.pollInfo={votes:t,lastVote:s&&s.dataset.polloptId,totalVote:parseInt(this.root.dataset.blogVoteSum,10)},this.dataset.replayPoll&&this.replayPreJoinVote()},e.prototype.replayPreJoinVote=function(){var t=this;if(!this.isVotedOrEnded())try{var e=sessionStorage.getItem("prejoin-poll-vote");if(!e)return;sessionStorage.removeItem("prejoin-poll-vote");var o=this.qs('[data-pollopt-id="'+e+'"]');if(!o)return;var n=document.referrer===location.href?"detail_page":"feed_card";setTimeout(function(){t.votePollById(e),t.collectEvent("auto",n,o.dataset.polloptType)},1e3)}catch(t){console.log(t)}},Object.defineProperty(e.prototype,"events",{get:function(){return["click/.poll-item .label/clickPollItem"]},enumerable:!0,configurable:!0}),e.prototype.isVotedOrEnded=function(){return this.root.classList.contains("voting-end")||this.root.classList.contains("voted")},e.prototype.clickPollItem=function(t){if(!this.isVotedOrEnded()){if(t.preventDefault(),this.dataset.needHidden)return this.app.alert(this.dataset.needHidden);var e=t.currentTarget.closest(".poll-item"),o=e.dataset.polloptId;this.votePollById(o);var n=this.dataset.eventLabel;this.collectEvent("submit",n,e.dataset.polloptType)}},e.prototype.collectEvent=function(t,e,o){this.app.sendGa({eventCategory:"Poll Vote",eventAction:t,eventLabel:e}),collectTEA("votes_on_a_poll",{type:{0:"plain",1:"favorite"}[o],source:"detail_page"===e?"Detail View":"Feed Card"})},e.prototype.votePollById=function(t){var e=this,o=ServerData.community.ndcId,n=this.root.dataset.blogId;Object(r.j)(o,n,t).catch(function(t){e.hideResultView(),e.app.alert(t.message)}),t||(t=this.pollInfo.lastVote),this.pollInfo.votes[t]+=1,this.pollInfo.totalVote+=1,this.pollInfo.lastVote=t,this.emit("voted",t),this.updateView(t)},e.prototype.updateView=function(t){var e=this.qsa(".poll-item"),o=this.pollInfo,n=function(t,e){var o={},n=Object.keys(t),i=0;return n.slice(0,-1).forEach(function(n){var r=(t[n]/e*100).toFixed(1);o[n]=r,i+=+r}),o[n[n.length-1]]=(100-i).toFixed(1),o}(o.votes,o.totalVote);this.showResultView(e,t,n),this.applyRootClass(),this.scheduleVoteAnimation(e,n)},e.prototype.applyRootClass=function(){this.root.classList.add("voting-end","voted"),this.root.classList.remove("voting")},e.prototype.showResultView=function(t,e,o){this.emit("show-result",{selectedId:e,partition:o});for(var n=0,i=t.length;n<i;n++)this.showOneItemResult(t[n],e,o)},e.prototype.showOneItemResult=function(t,e,o){var n=t.dataset.polloptId,i=n===e,r=t.querySelector(".title");if(i){t.classList.add("voted-item");var a=r.querySelector(".content");a.innerHTML='<i class="amino-icon amino-icon-check"></i>'+a.innerHTML}else{t.classList.remove("voted-item");var s=t.querySelector(".amino-icon-check");s&&s.remove()}r.innerHTML+='<span class="partition">'+o[n]+"%</span>"},e.prototype.revertPollInfo=function(){var t=this.pollInfo.lastVote;t&&(this.pollInfo.votes[t]-=1,this.pollInfo.totalVote-=1)},e.prototype.hideResultView=function(){this.revertPollInfo(),this.root.classList.remove("voted","voting-end"),this.root.classList.add("voting");var t=this.qsa(".poll-item");this.emit("hide-result");for(var e=0,o=t.length;e<o;e++)this.hideOneItemResult(t[e])},e.prototype.hideOneItemResult=function(t){t.classList.remove("voted-item");var e=t.querySelector(".amino-icon-check");e&&e.remove();var o=t.querySelector("span.partition");o&&o.remove(),t.querySelector(".bar").style.width=""},e.prototype.scheduleVoteAnimation=function(t,e){var o=this;Object(a.o)(this.root),requestAnimationFrame(function(){o.root.classList.add("voting-progress");for(var n=0,i=t.length;n<i;n++){var r=t[n],a=r.dataset.polloptId;r.querySelector(".bar").style.width=e[a]+"%"}}),setTimeout(function(){o.root.classList.remove("voting-progress")},500)},e}(i.a);e.default=s},350:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(338),a=o(341),s=o(342),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["click/@root/logout"]},enumerable:!0,configurable:!0}),e.prototype.logout=function(){Promise.all([Object(r.h)()]).then(function(){collectTEA("log_out",{source:"Top Nav Popup"}),setTimeout(function(){return location.reload()},100)},function(t){console.error(t),setTimeout(function(){return location.reload()},100)}),Object(a.g)(Object(a.b)()),Object(a.h)("logout"),Object(s.removeCommunityHTMLCache)()},e}(i.a);e.default=c},351:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(338),a=o(118),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),e.prototype.init=function(){this.isOpen=!1,this.loaded=!1,this.close=this.close.bind(this),this.container=this.qs(".global-identity-container")},Object.defineProperty(e.prototype,"events",{get:function(){return["click/@root/showDropdown","click/.action-show-menu/onClickShowMenu","click/.overlay/onClickOverlay","wheel/.global-identity-container>.scroller/toggleScrollBar"]},enumerable:!0,configurable:!0}),e.prototype.toggleScrollBar=function(t){if(this.root.classList.contains("menu-show"))t.preventDefault();else{var e=this.scroller.scrollTop;if(t.deltaY>=0)return this.scroller.style.overflow="",void(e>=this.scroller.scrollHeight-this.scroller.clientHeight&&t.preventDefault());e<=0&&(this.scroller.style.overflow="hidden")}},e.prototype.showDropdown=function(t){var e=this;t.target.closest(".global-identity-container")||(this.isOpen?this.doClose():(this.doOpen(),collectTEA("top_nav_popup"),this.loaded||(this.container.innerHTML=o(361)(),Object(r.d)().then(function(t){e.container.innerHTML=t,e.scroller=e.qs(".global-identity-container>.scroller"),e.loaded=!0,e.container.style.overflow="hidden",e.renderChildren()}).catch(function(){e.container.innerHTML='<div class="global-identity">\n            <p class="empty">Something wrong happened! Please refresh the page!</p>\n            </div>'}))))},e.prototype.onClickShowMenu=function(t){t.preventDefault(),this.root.classList.add("menu-show"),this.qsChild('[data-vce="user/btn-leave-community"]').dataset.targetNdcId=t.currentTarget.dataset.targetNdcId},e.prototype.onClickOverlay=function(t){this.root.classList.remove("menu-show")},e}(Object(a.b)(i.a));e.default=s},352:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(5),a=o(105),s=o(2),c=o(14),l=o(168),u=0;function d(t){return t.type===u&&t.content}var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["mouseenter/@root/displayPreview","mouseleave/@root/removePreview","click/@root/switchToThread"]},enumerable:!0,configurable:!0}),e.prototype.switchToThread=function(){var t=this,e=this.app.userChatWindow;e&&!this.isTransmuted?e.switchToThread(this.dataset.threadId,{action:a.a("PUBLIC_THREAD_REPLAY")?"auto":"click",source:"sidebar_public_chatrooms"}).then(function(){t.emit("click-completed")}).catch(function(t){console.error(t)}):(a.c("PUBLIC_THREAD_REPLAY",this.dataset.threadId),this.emit("click-completed"))},e.prototype.removePreview=function(){this.previewDisplayed=!1,this.root.classList.remove("chat-preview"),clearTimeout(this.timeout);var t=[].slice.call(this.previewContainer.children);setTimeout(function(){t.forEach(function(t){return t.remove()})},200)},e.prototype.init=function(){this.previewContainer=this.root.querySelector(".chat-message-preview");var t=a.a("PUBLIC_THREAD_REPLAY");t&&this.app.userChatWindow&&(this.app.userChatWindow.switchToThread(t,{action:"auto",source:"sidebar_public_chatrooms"}),a.b("PUBLIC_THREAD_REPLAY"))},e.prototype.displayPreview=function(t){var e=this;this.previewDisplayed||(this.previewDisplayed=!0,this.fetchPreview().then(function(t){0!==t.length&&e.previewDisplayed&&(e.root.classList.add("chat-preview"),e.displayNewComment(0,t,!0))}))},e.prototype.fetchPreview=function(){var t=this;return this.messages?Promise.resolve(this.messages):function(t){return Object(r.h)("chat-thread-messages",{ndcId:ServerData.community.ndcId,threadId:t,size:25}).then(function(t){return(t=[].slice.call(t)).filter(d).slice(0,5)})}(this.root.dataset.threadId).then(function(e){return t.messages=e,e})},e.prototype.displayNewComment=function(t,e,o){var n=e[t];t=(t+1)%e.length,this.insertCommentToDom(n),this.scheduleNextDisplay(t,e,o)&&this.animateAndRemoveExcessiveElements()},e.prototype.insertCommentToDom=function(t){var e=function(t){if(!t)return{};return{avatar:(t.author&&t.author.icon||"/static/img/user-icon-placeholder.png").replace("_00","_68"),text:t.content}}(t),o=Object(s.f)(l(e));c.a.run(o),this.previewContainer.appendChild(o)},e.prototype.scheduleNextDisplay=function(t,e,o){var n=this;return this.previewContainer.children.length<2?(e.length>2&&Object(s.m)(function(i){n.displayNewComment(t,e,o)}),!1):(clearTimeout(this.timeout),this.timeout=setTimeout(function(o){n.displayNewComment(t,e,!1)},o?800:2e3),!0)},e.prototype.animateAndRemoveExcessiveElements=function(){var t=this.previewContainer;Object(s.u)(t),t.classList.add("newcoming"),Object(s.v)(t),t.classList.remove("newcoming"),[].slice.call(t.children,0,-2).forEach(function(t){t.classList.add("dying"),Object(s.b)(t,1e3).then(function(e){t.remove()})})},e}(i.a);e.default=h},353:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(359),a=o(5),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["click/.action-edit/editPost","click/.action-delete/deletePost"]},enumerable:!0,configurable:!0}),e.prototype.editPost=function(t){var e=this;if("true"===this.dataset.canEdit){if(!r.b){var o=t.target.closest(".menu-item");o.classList.add("loading"),Object(r.d)("edit",{postId:this.dataset.postId,postType:this.dataset.postType}).then(function(){return e.closeMenu(o)}).catch(function(){return e.closeMenu(o)})}}else this.app.alert(this.dataset.noEditText,_("Got it"))},e.prototype.isFansOnly=function(){try{return Boolean(this.dataset.gated)}catch(t){return!1}},e.prototype.deletePost=function(t){var e=this;this.app.confirm(this.dataset.confirmDelete).then(function(){return Object(a.h)("/api/post/delete",{ndcId:ServerData.community.ndcId,postId:e.dataset.postId,postType:e.dataset.postType}).then(function(){var t=e.isFansOnly();e.app.sendGa({eventCategory:"Post",eventLabel:"delete",eventAction:t?"gated":"public"}),e.dataset.redirectUrl?location.replace(e.dataset.redirectUrl):location.reload()}).catch(e.app.globalCatcher).catch(e.app.toastErrorHandler())},function(){})},e.prototype.closeMenu=function(t){(t.classList.remove("loading"),"doClose"in this.parent)&&this.parent.doClose()},e}(i.a);e.default=s},354:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(19),a=o(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["click/.voting .view-result/promptNeedVote","click/.voted .change-vote/revertVote"]},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;this.extraAction=this.qs(".poll-extra-action"),this.voterList=this.qs(".voter-list");var e=this.poll=function(t){var e=t.querySelector('[data-vce="user/vote-poll"]');if(e)return r.VComponent.get(e)}(this.root);this.hideResult=!1,e&&(e.on("voted",function(){t.extraAction.classList.add("voted"),t.extraAction.classList.remove("voting"),t.incrementVoterCount()}),e.on("show-result",function(e){var o=e.selectedId;t.loadVoterImages(o)}))},e.prototype.incrementVoterCount=function(){var t=this.qs("span.voter-count"),e=t.textContent,o=/\d+/.exec(e);if(o){var n=parseInt(o[0],10)||0;t.textContent=e.replace(/\d+/,String(n+1))}},e.prototype.promptNeedVote=function(t){if(this.hideResult)this.poll.votePollById(void 0);else{var e=t.currentTarget.dataset,o=e.mainText,n=e.closeText;this.app.alert(o,n)}},e.prototype.revertVote=function(){this.poll.hideResultView(),this.hideVoterImages(),this.extraAction.classList.remove("voted"),this.extraAction.classList.add("voting"),this.hideResult=!0},e.prototype.hideVoterImages=function(){var t=this.voterList;t.classList.add("hide");for(var e=t.querySelectorAll(".self-vote"),o=0,n=e.length;o<n;o++)e[o].remove()},e.prototype.loadVoterImages=function(t){var e=this.qsa(".poll-options .poll-item"),o=this.voterList;if(o&&o.classList.contains("voter-list")){o.classList.remove("hide");for(var n=o.closest("[data-vce]"),i=r.VComponent.get(n).children.image||[],s=0,c=i.length;s<c;s++)i[s].load();if(ServerData.memberIcon){for(var l=e[0],u=o.firstElementChild;l.dataset.polloptId!==t;)l=l.nextElementSibling,u=u.nextElementSibling;4===u.children.length&&u.children[0].remove();var d=Object(a.f)('\n            <a class="voter self-vote" href="'+ServerData.memberUrl+'">\n                <img src="'+ServerData.memberIcon+'" class="avatar img-cover"/>\n            </a>\n        '),h=document.createElement("img");h.classList.add("voter","self-vote"),h.src=ServerData.memberIcon,u.insertBefore(d,u.firstElementChild)}}},e}(i.a);e.default=s},355:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(105),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["click/@root/switchToThread"]},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=r.a("CHAT_THREAD_PAGE_REPLAY");this.app.userChatWindow&&t===this.dataset.threadId&&this.switchToThread()},e.prototype.switchToThread=function(){var t=this,e=this.app.userChatWindow;if(e&&!this.isTransmuted){var o=r.a("CHAT_THREAD_PAGE_REPLAY")?"auto":"click";e.switchToThread(this.dataset.threadId,{source:"chat_thread_page",action:o}).then(function(){t.emit("click-completed")}).catch(function(t){})}else r.c("CHAT_THREAD_PAGE_REPLAY",this.dataset.threadId),this.emit("click-completed")},e}(i.a);e.default=a},356:function(t,e,o){"use strict";o.r(e);var n=o(0),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["mouseleave/@root/mouseleave/","mouseenter/@root/mouseenter/"]},enumerable:!0,configurable:!0}),e.prototype.bindDomEvents=function(){return this.app.globalChatName=this,t.prototype.bindDomEvents.call(this)},e.prototype.mouseenter=function(t){var e=this.dataset.enterText;this.applyEnterStyle(e),clearTimeout(this.timer),this.timer=null},e.prototype.mouseleave=function(){var t=this;this.hideTimer=setTimeout(function(){t.hideName()},100)},e.prototype.displayName=function(t){var e=t.top,o=t.left,n=t.right,i=t.bottom,r=t.theme,a=void 0===r?"":r,s=t.referType,c=void 0===s?"":s,l=t.href,u=t.communityName;clearTimeout(this.hideTimer),clearTimeout(this.timer),this.hideTimer=null,this.timer=null;var d=this.qs(".chat-community-name-indicator"),h=d.style;h.display="block",h.top=null!=e?e+"px":"",h.left=null!=o?o+"px":"",h.bottom=null!=i?i+"px":"",h.right=null!=n?n+"px":"",d.href=l,d.dataset.referType=c,d.className="chat-community-name-indicator "+a,this.unapplyEnterStyle(u)},e.prototype.delayHideName=function(){var t=this;this.timer||this.isHover||(this.timer=setTimeout(function(){t.hideName()},200))},e.prototype.hideName=function(){this.qs(".chat-community-name-indicator").style.display="none",this.isHover=!1,clearTimeout(this.timer),this.timer=null},e.prototype.unapplyEnterStyle=function(t){var e=this.qs(".chat-community-name-indicator");e.classList.remove("hover"),this.isHover=!1,e.querySelector(".bubble").style.height="";var o=e.querySelector(".real-content");o.style.minWidth="",o.style.textAlign="",o.textContent=t},e.prototype.applyEnterStyle=function(t){var e=this.qs(".chat-community-name-indicator");e.classList.add("hover"),this.isHover=!0;var o=e.querySelector(".bubble"),n=o.getBoundingClientRect().height;o.style.height=n+"px";var i=e.querySelector(".real-content"),r=i.getBoundingClientRect().width;i.style.minWidth=r+"px",i.textContent=t,i.style.textAlign="center"},e}(o(3).a);e.default=i},357:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(10),a=o(338),s="highlight-following-feed",c=new r.a({key:"highlight-following-feed",expire:864e5}),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["click/@root/handleClick","mouseleave/@root/removeClassLoaded"]},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;this.requested=this.requested.bind(this),this.handleError=this.app.toastErrorHandler(this.handleError.bind(this));var e=this.app.qs(".home-section-nav .section-item .amino-icon-feed"),o=e&&e.closest(".section-item");this.feedItem=o,function(){try{return sessionStorage.getItem(s)}catch(t){return}}()&&this.feedItem&&(this.feedItem.classList.add("hide"),this.app.initPromise.then(function(){t.showFollowingIntro()}))},e.prototype.handleClick=function(){var t=this.root.classList;t.contains("loading")||(t.contains("status-forward")?this.unfollow():this.follow())},e.prototype.updateNumber=function(t){var e=this.root.closest(".j-followee-number-container"),o=e&&e.querySelector(".j-followee-number-target");if(o){var n=parseInt(o.textContent,10);o.textContent="follow"===t?n+1:n>0?n-1:0}},e.prototype.follow=function(){var t=this;this.root.classList.add("loading");var e=ServerData.community.ndcId,o=this.dataset.followee;this.app.sendGa({eventCategory:"Follow",eventAction:this.feedItem?"submit":"auto",eventLabel:this.dataset.followEventLabel,nonInteraction:!this.feedItem}),collectTEA("follow_user",{source:{author_card:"Author Card",profile_page:"User Profile",chat_info:"Chat Info"}[this.dataset.followEventLabel]}),Object(a.c)(e,o).then(function(e){var o=e.joinedCount;t.updateNumber("follow"),t.requested(o),t.showFollowingIntro()}).catch(this.handleError)},e.prototype.requested=function(t){0===t&&this.feedItem?this.feedItem.classList.add("hide"):1!==t||this.feedItem||function(){try{sessionStorage.setItem(s,"1")}catch(t){}}(),this.root.classList.toggle("status-forward"),this.root.classList.remove("loading"),this.root.classList.add("loaded"),this.emit("click-completed")},e.prototype.showFollowingIntro=function(){var t=this,e=this.feedItem;e&&e.classList.contains("hide")&&(!function(){try{sessionStorage.removeItem(s)}catch(t){}}(),e.classList.remove("hide"),c.get()||setTimeout(function(){t.app.openPopup("follow-highlight",{closeByOverlay:1}),c.set({})},1e3))},e.prototype.handleError=function(){this.root.classList.remove("loading"),this.emit("click-completed")},e.prototype.unfollow=function(){var t=this;this.root.classList.add("loading");var e=ServerData.community.ndcId,o=this.dataset.followee,n=this.dataset.follower;this.app.sendGa({eventCategory:"Unfollow",eventAction:"submit",eventLabel:this.dataset.eventLabel}),collectTEA("unfollow_user",{source:{author_card:"Author Card",profile_page:"User Profile",chat_info:"Chat Info"}[this.dataset.followEventLabel]}),Object(a.i)(e,o,n).then(function(e){var o=e.joinedCount;t.requested(o),t.updateNumber("unfollow")}).catch(this.handleError)},e.prototype.removeClassLoaded=function(){this.root.classList.remove("loaded")},e}(i.a);e.default=l},358:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(22),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["keydown/.input/filter"]},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;this.input=this.qs(".input"),this.input&&(this.notFound=this.qs(".no-result-found"),this.aminos=this.qs(".aminos-list"),this.list=this.children.list[0],this.list.on("load",function(){t.doFilter()}),this.list.shouldIncludeItem=function(e){var o=t.input.value.toLowerCase();return t.isAminoMatch(e,o)||(e.style.display="none"),!0},this.doFilter=Object(r.debounce)(100,this.doFilter.bind(this)))},e.prototype.filter=function(t){this.doFilter(t)},e.prototype.isAminoMatch=function(t,e){return t.querySelector(".name").textContent.replace(/:\w+:/g,"").toLowerCase().indexOf(e)>=0},e.prototype.doFilter=function(t){for(var e,o=this.input.value.toLowerCase(),n=this.aminos.querySelectorAll(".amino-card"),i=0,r=0,a=n.length;r<a;r++){var s=n[r];this.isAminoMatch(s,o)?(s.style.display="",s.dataset.referType=o?"nav_popup_search":"nav_popup_joined",i+=1,e=s):s.style.display="none"}this.notFound.style.display=0===i?"block":"",1===i&&t&&13===t.keyCode&&e.click(),this.list.paginatorInViewport()&&this.list.loadNext()},e}(i.a);e.default=a},359:function(t,e,o){"use strict";o.d(e,"a",function(){return r}),o.d(e,"c",function(){return a}),o.d(e,"b",function(){return s}),o.d(e,"d",function(){return l});var n=o(32),i=o(9),r=new n.a,a=ServerData.community&&Object(i.b)(ServerData.community.ndcId);window.addEventListener("message",function(t){if(t.origin===location.origin){var e=t.data,o=e.type,n=e.payload;"compose"===e.identity&&r.emit(o,n)}}),r.on("cancelCompose",u),r.on("closeDraft",u);var s=!1,c=null;function l(t,e){var o=document.documentElement,n=document.body;if(s)throw new Error("duplicate loading!");s=!0,n.style.paddingRight=window.innerWidth-o.clientWidth+"px",n.style.setProperty("--scrollbar-padding",window.innerWidth-o.clientWidth+"px"),o.classList.add("modal-open"),c=document.createElement("iframe");var i="/partial/compose-post?ndcId="+a+"&type="+t;return e&&(i+="&"+function(t){for(var e=[],o=0,n=Object.keys(t);o<n.length;o++){var i=n[o];e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]))}return e.join("&")}(e)),c.src=i,c.classList.add("compose-frame"),n.appendChild(c),n.style.overflow="hidden",new Promise(function(t,e){c.onload=function(){c.classList.add("loaded"),s=!1,t()},c.onerror=function(t){s=!1,e(t)}})}function u(){c&&(c.classList.remove("loaded"),setTimeout(function(){c.remove(),document.body.style.overflow="",c=null},200));var t=document.documentElement;document.body.style.paddingRight="",document.body.style.setProperty("--scrollbar-padding",""),t.classList.remove("modal-open")}},360:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(30),a=o(359),s=o(105);var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["click/.create-post/createPost","click/.open-draft/openDraft","mouseover/.open-draft/showDraftHint","mouseout/.open-draft/closeDraftHint","click/@root/handlePrelogin"]},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this.updateDraft.bind(this);a.a.on("cancelCompose",t),a.a.on("closeDraft",t),a.a.on("blogPosted",function(t){window.location.href=t}),this.updateDraft(),s.a("COMPOSE_POST_REPLAY")&&(this.createPost(),s.b("COMPOSE_POST_REPLAY"))},e.prototype.handlePrelogin=function(){this.isTransmuted&&(s.c("COMPOSE_POST_REPLAY","1"),this.emit("click-completed"))},e.prototype.updateDraft=function(){var t=this;(function(){if("object"!=typeof indexedDB)return Promise.resolve(0);var t=ServerData.accountId;if(!t||!a.c)return Promise.resolve(0);var e=a.c+"|"+t;return Object(r.c)().then(function(t){for(var o=0,n=0,i=t;n<i.length;n++){var r=i[n];"string"==typeof r&&0===r.indexOf(e)&&(o+=1)}return o})})().then(function(e){if(0===e)t.root.classList.remove("has-draft");else{t.root.classList.add("has-draft"),t.qs(".draft-num").textContent=e>9?"9+":String(e);var o=t.qs(".draft-indicator");o.textContent=1===e?o.dataset.templateSingle:o.dataset.template.replace("{{num}}",String(e))}})},e.prototype.showDraftHint=function(){this.qs(".draft-indicator").classList.add("active")},e.prototype.closeDraftHint=function(){this.qs(".draft-indicator").classList.remove("active")},e.prototype.openFrame=function(t){var e=this;this.root.classList.contains("loading")||(this.root.classList.add("loading"),Object(a.d)(t).then(function(){return e.root.classList.remove("loading")},function(){return e.root.classList.remove("loading")}))},e.prototype.createPost=function(){this.openFrame("create")},e.prototype.openDraft=function(){this.openFrame("draft")},e}(i.a);e.default=c},361:function(t,e){t.exports=function(t){return'<div class="mask-container"> <div class="logo-mask fg"> <svg class="amino-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.5 144.2"> <g> <path d="M298 31.7c10 0 16.5-7.1 16.5-15.8C314.5 7.1 307.6 0 298 0c-9.7 0-16.5 7.1-16.5 15.8 0 8.8 6.7 15.9 16.5 15.9z"/> <path d="M468.8 47.7c-24.2 0-41.3 18.6-41.3 47.2 0 7.1.7 13.5 2.2 19.3-3.9 3.2-7.5 5.4-10.9 5.4-5.2 0-7.6-3.1-7.6-9.8V79.4c0-19-11.5-31.6-29.3-31.6-12.3 0-21.3 4.8-27.9 11.7-.5-.8-1.1-2-1.8-3.2-1.9-3.4-4.4-5.9-9.4-5.9H339c-4.2 0-6.6 2.9-6.6 7.9v54.3c-4.5 4-9.6 7.1-13.8 7.1-5.2 0-7.6-3.2-7.6-9.8V58.3c0-5.2-2-7.9-6.8-7.9h-13.3c-4.2 0-6.6 2.9-6.6 7.9v55.8c-4.5 3.5-8.2 5.6-11.9 5.6-5.2 0-7.6-3.1-7.6-9.8V79.4c0-19-10.2-31.6-28-31.6-12.3 0-21.7 5.5-28.3 12.5-4.8-7.5-12.5-12.4-23.5-12.4s-18.5 4.1-26.5 11.5c-3.4-7.1-8-8.9-13.4-8.9-9.6 0-30.8 5.9-46.8 12.7-7.2-18.5-18.1-43.6-21.6-51.5-.5-1.5-1.7-3.8-2.7-5.2C71.4 2.8 67.8.8 62.6.8c-4.6 0-7.9 1.9-10.4 4.8-1.3 1.5-2.8 4-3.6 5.9-4.5 10.9-33.3 84.4-47.4 120.7-2.2 5.7-1.8 9.4 3.7 9.4h14.6c4.3 0 5.9-1.9 10.2-6.4 15.7-16.7 34.7-29.8 52.2-38.8 7.1 17.3 14.2 35.2 15.7 38.8 2.1 5.2 4.8 6.4 9.6 6.4h14.2c5.5 0 6.4-3.7 4.6-8.5-3.2-8.5-10.9-27.4-19.1-47.8 9.5-4.5 21.1-8 24.8-8 4 0 5.5 2.8 5.5 7.1v49.2c0 5.2 2 7.9 6.8 7.9h13.3c4.2 0 6.6-2.9 6.6-7.9V88c0-8.6 3.9-14.9 12.2-14.9 8.3 0 11.5 6.4 11.5 14.9v45.6c0 5.2 2 7.9 6.8 7.9h13.3c4.2 0 6.6-2.9 6.6-7.9V88c0-8.6 3.9-14.9 12.2-14.9 8.3 0 11.5 6.4 11.5 14.9v29.8c0 16.2 8.9 26.3 23.2 26.3 11.7 0 19.7-4.1 27.2-9.9 3.9 6.3 10.6 9.9 19.1 9.9 10.1 0 18.4-5.1 25-10 .1 4.8 2.2 7.4 6.8 7.4h13.3c4.2 0 6.6-2.9 6.6-7.9V88c0-8.6 4.7-14.9 12.9-14.9s12.3 6.4 12.3 14.9v29.8c0 16.2 8.9 26.3 23.2 26.3 12.1 0 23.3-5.6 31.1-12 6.8 7.7 16.7 12 30 12 28.9 0 42.7-19.2 42.7-49.2.1-28.6-16.3-47.2-42.6-47.2zM43.3 94.3c3.1-7.6 9.6-24.9 13.9-35.9 1.5-3.9 2.7-6 5.4-6 2.8 0 4.1 3.3 5.3 6.1 1.9 4.5 3.9 10.5 5.7 15.4-10.3 5.3-21.3 13-30.3 20.4zm426.2 25.2c-10.1 0-14.6-9.7-14.6-24.5 0-13.4 5.5-22.6 14.6-22.6 9.5 0 14.6 9.2 14.6 22.6 0 14.8-3.8 24.5-14.6 24.5z"/> </g> </svg> </div> <div class="logo-mask bg"> <svg class="amino-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.5 144.2"> <g> <path d="M298 31.7c10 0 16.5-7.1 16.5-15.8C314.5 7.1 307.6 0 298 0c-9.7 0-16.5 7.1-16.5 15.8 0 8.8 6.7 15.9 16.5 15.9z"/> <path d="M468.8 47.7c-24.2 0-41.3 18.6-41.3 47.2 0 7.1.7 13.5 2.2 19.3-3.9 3.2-7.5 5.4-10.9 5.4-5.2 0-7.6-3.1-7.6-9.8V79.4c0-19-11.5-31.6-29.3-31.6-12.3 0-21.3 4.8-27.9 11.7-.5-.8-1.1-2-1.8-3.2-1.9-3.4-4.4-5.9-9.4-5.9H339c-4.2 0-6.6 2.9-6.6 7.9v54.3c-4.5 4-9.6 7.1-13.8 7.1-5.2 0-7.6-3.2-7.6-9.8V58.3c0-5.2-2-7.9-6.8-7.9h-13.3c-4.2 0-6.6 2.9-6.6 7.9v55.8c-4.5 3.5-8.2 5.6-11.9 5.6-5.2 0-7.6-3.1-7.6-9.8V79.4c0-19-10.2-31.6-28-31.6-12.3 0-21.7 5.5-28.3 12.5-4.8-7.5-12.5-12.4-23.5-12.4s-18.5 4.1-26.5 11.5c-3.4-7.1-8-8.9-13.4-8.9-9.6 0-30.8 5.9-46.8 12.7-7.2-18.5-18.1-43.6-21.6-51.5-.5-1.5-1.7-3.8-2.7-5.2C71.4 2.8 67.8.8 62.6.8c-4.6 0-7.9 1.9-10.4 4.8-1.3 1.5-2.8 4-3.6 5.9-4.5 10.9-33.3 84.4-47.4 120.7-2.2 5.7-1.8 9.4 3.7 9.4h14.6c4.3 0 5.9-1.9 10.2-6.4 15.7-16.7 34.7-29.8 52.2-38.8 7.1 17.3 14.2 35.2 15.7 38.8 2.1 5.2 4.8 6.4 9.6 6.4h14.2c5.5 0 6.4-3.7 4.6-8.5-3.2-8.5-10.9-27.4-19.1-47.8 9.5-4.5 21.1-8 24.8-8 4 0 5.5 2.8 5.5 7.1v49.2c0 5.2 2 7.9 6.8 7.9h13.3c4.2 0 6.6-2.9 6.6-7.9V88c0-8.6 3.9-14.9 12.2-14.9 8.3 0 11.5 6.4 11.5 14.9v45.6c0 5.2 2 7.9 6.8 7.9h13.3c4.2 0 6.6-2.9 6.6-7.9V88c0-8.6 3.9-14.9 12.2-14.9 8.3 0 11.5 6.4 11.5 14.9v29.8c0 16.2 8.9 26.3 23.2 26.3 11.7 0 19.7-4.1 27.2-9.9 3.9 6.3 10.6 9.9 19.1 9.9 10.1 0 18.4-5.1 25-10 .1 4.8 2.2 7.4 6.8 7.4h13.3c4.2 0 6.6-2.9 6.6-7.9V88c0-8.6 4.7-14.9 12.9-14.9s12.3 6.4 12.3 14.9v29.8c0 16.2 8.9 26.3 23.2 26.3 12.1 0 23.3-5.6 31.1-12 6.8 7.7 16.7 12 30 12 28.9 0 42.7-19.2 42.7-49.2.1-28.6-16.3-47.2-42.6-47.2zM43.3 94.3c3.1-7.6 9.6-24.9 13.9-35.9 1.5-3.9 2.7-6 5.4-6 2.8 0 4.1 3.3 5.3 6.1 1.9 4.5 3.9 10.5 5.7 15.4-10.3 5.3-21.3 13-30.3 20.4zm426.2 25.2c-10.1 0-14.6-9.7-14.6-24.5 0-13.4 5.5-22.6 14.6-22.6 9.5 0 14.6 9.2 14.6 22.6 0 14.8-3.8 24.5-14.6 24.5z"/> </g> </svg> </div></div>'}},362:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(105),a=o(2),s=o(341),c=o(364),l=o(9),u=ServerData.community&&Object(l.b)(ServerData.community.ndcId),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),e.prototype.bindDomEvents=function(){var t,e;if(this.app.userChatWindow=this,this.listenEmitter(),this.qs(".loading-overlay").innerHTML=o(361)(),t=this,(e=document.querySelector(".sidebar-card .chat-icon-wrapper"))&&e.addEventListener("click",function(){t.switchToCommunity(u,{source:"community_card",action:"click"},{forceReload:!0})}),this.root.classList.remove("cloak"),!function(t){var e=r.a(h);return!!e&&(r.b(h),t.switchToThread(e.threadId,{action:"auto",source:"suggested_public_chatrooms"}),!0)}(this)){var n=Object(s.b)();if(n)return Object(s.c)()?(this.currentNdcId=n,void Object(s.k)(n)):void this.firstOpen(n)}},e.prototype.firstOpen=function(t){Object(a.u)(this.root);var e=Object(s.d)();this.switchToCommunity(t),Object(s.f)(e),e&&this.root.classList.add("minimized"),Object(a.v)(this.root)},e.prototype.listenEmitter=function(){var t=this;s.a.on("showMedia",this.showMedia.bind(this)),s.a.on("closeChatWindow",this.closeChatWindow.bind(this)),s.a.on("toggleMinimize",this.toggleMinimize.bind(this)),s.a.on("requestJoin",function(t){if(t.ndcId!==ServerData.community.ndcId)return;var e=Object.assign({successRedirect:"",source:"Enter Chat Thread"},t);this.app.requireLoginAndJoin(e).then(function(){r.c(h,t),location.reload()})}.bind(this)),s.a.on("forceChatExit",this.forceExit.bind(this)),s.a.on("sendNotification",this.changeTab.bind(this)),s.a.on("minimizedIconHover",this.toggleMinimizeHover.bind(this)),s.a.on("requestJoinVip",function(e){var o=e.influencer,n=e.motivation;t.app.requestJoinOrRenewFanclub(o,n)})},e.prototype.switchToThread=function(t,e){var o=this,n=e.source,i=void 0===n?"":n,r=e.action,a=void 0===r?"":r,c=e.ndcId,l=void 0===c?u:c;return this.root.classList.remove("minimized"),l?this.switchToCommunity(l).then(function(){return Object(s.l)(l,t,{source:i,action:a})}).catch(function(t){o.app.toastErrorHandler()(t)}):Promise.resolve()},e.prototype.addLoading=function(){clearTimeout(this.loadingTimeout),this.root.classList.add("loading")},e.prototype.removeLoading=function(t){var e=this;clearTimeout(this.loadingTimeout),0!==t?this.loadingTimeout=setTimeout(function(){e.root.classList.remove("loading")},t):this.root.classList.remove("loading")},e.prototype.switchToCommunity=function(t,e,o){var n=this;void 0===o&&(o={forceReload:!1}),Object(c.a)();var i=t!==this.currentNdcId,r=this.root.classList;this.currentNdcId=t,r.remove("close","minimized"),this.addLoading();var a=!i&&Object(s.d)()?300:0;return Object(s.f)(!1),Object(s.k)(t,e,o).then(function(){n.removeLoading(a),Object(s.e)(i?void 0:e)})},e.prototype.showMedia=function(t){var e=this;if(this.media=t,!this.loadingLightbox){if(this.popup)return this.popup.render(!0),void this.app.openModal(this.popup);this.loadingLightbox=!1;var o=this,n={container:{isFirst:function(){return!0},isLast:function(){return!0}},get current(){return o.media},pager:{current:1,max:1},hideControl:!0,autoplay:this.media.autoplay};this.app.openPopup("lightbox",n).then(function(t){e.popup=t,e.loadingLightbox=!1})}},e.prototype.closeChatWindow=function(){this.root.classList.add("close"),Object(s.j)()},e.prototype.toggleMinimize=function(t){this.root.classList.toggle("minimized",t),Object(s.f)(t),t||(this.addLoading(),this.removeLoading(350))},e.prototype.forceExit=function(t){Object(s.g)(t),Object(s.j)(),location.reload()},e.prototype.changeTab=function(t){Object(s.c)()||""+t.ndcId!==this.currentNdcId||function(t){if(!t.aps.sound)return;var e="💬 ";try{e+=t.aps.alert.split(":")[0]+" | "}catch(t){e+="| "}var o=m;Object(c.c)(e),Object(c.b)(o),clearInterval(p),p=setInterval(function(){o=o===m?f:m,Object(c.b)(o)},500)}(t)},e.prototype.toggleMinimizeHover=function(t){if(t.show){var e=this.root.getBoundingClientRect(),o=e.top-5,n=e.left+25,i=t.href,r=t.communityName;this.app.globalChatName.displayName({top:o,left:n,href:i,communityName:r,referType:"minimized_chat_window",theme:"top"})}else t.instant?this.app.globalChatName.hideName():this.app.globalChatName.delayHideName()},e}(i.a);e.default=d;var h="REQUEST_JOIN_REPLAY";var p,f="/static/img/favicon.ico",m="/static/img/favicon2.ico";document.addEventListener("visibilitychange",function(){Object(c.b)(f),Object(c.c)(""),clearInterval(p)})},363:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(105),a=o(338),s=o(341),c="2",l="3",u=2;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return["click/@root/handleClick"]},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.endLoad=this.endLoad.bind(this),r.a("SINGLE_CHAT_REPLAY")===this.dataset.uid&&this.app.userChatWindow&&this.handleClick()},e.prototype.handleClick=function(){var t=this;if(!this.loading){if(!this.app.userChatWindow||this.isTransmuted)return this.emit("click-completed"),void r.c("SINGLE_CHAT_REPLAY",this.dataset.uid);if(!this.canChat())return this.app.alert(this.dataset.disabledText).then(function(){t.emit("click-completed")}),void this.app.sendGa({eventCategory:"Start 1-1 Chat",eventAction:"disabled"});this.startLoad(),this.createOrSwitchToChat().then(this.endLoad,this.endLoad)}},e.prototype.startLoad=function(){this.loading=!0,this.root.classList.add("loading")},e.prototype.endLoad=function(){this.loading=!1,this.root.classList.remove("loading")},e.prototype.createOrSwitchToChat=function(){var t=this,e=ServerData.community.ndcId.replace("x",""),o=this.dataset.uid;return Object(a.b)({ndcId:e,uid:o}).then(function(n){var i=n.threadList;if(0===i.length){var a=t.createChat(e,o);return r.b("SINGLE_CHAT_REPLAY"),a}var s=i[0];t.app.userChatWindow.switchToThread(s.threadId,{source:"profile_page",action:r.a("SINGLE_CHAT_REPLAY")?"auto":"click"}),r.b("SINGLE_CHAT_REPLAY")})},e.prototype.createChat=function(t,e){var o=this,n=!!r.a("SINGLE_CHAT_REPLAY");this.app.sendGa({eventCategory:"Start 1-1 Chat",eventAction:n?"auto":"click",eventLabel:"profile_page",nonInteraction:n}),collectTEA("start_chat_button_in_user_profile",{});var i=this.dataset,c=i.inviteText,l=i.sendText,u=i.placeholderText;return this.app.prompt(c,l,{placeholder:u,additionalClass:"initiate-single-chat-prompt"}).then(function(n){return o.app.sendGa({eventCategory:"Start 1-1 Chat",eventAction:"submit",eventLabel:"profile_page"}),collectTEA("user_creates_a_chat",{type:"1-1",source:"User Profile"}),Object(a.a)({ndcId:t,uid:e,initialMessageContent:n})}).then(function(e){var n=e.thread;e.messageList;return o.app.userChatWindow.switchToCommunity(t).then(function(){return Object(s.i)({ndcId:t,thread:n,source:"profile_page",action:"click"})})}).catch(function(t){console.error(t),o.app.showToast(t.message||t.response&&t.response.message,2,{additionalClass:"toast-warn"})})},e.prototype.canChat=function(){var t=this.dataset.chatPrivilege;return t!==l&&(t!==c||!!(+this.dataset.followStatus&u))},e}(i.a);e.default=d},364:function(t,e,o){"use strict";o.d(e,"a",function(){return c}),o.d(e,"d",function(){return l}),o.d(e,"b",function(){return u}),o.d(e,"c",function(){return h});var n=o(105),i="function"==typeof Notification,r=!1;if(i){var a=Notification.permission;"granted"===a?r=!0:"denied"===a&&(r=!1)}var s="NOTIFICATION_PERMISSION";function c(){i&&(Object(n.a)(s)||(Object(n.c)(s,1),function(){try{return Notification.requestPermission().then(function(t){return t})}catch(t){return new Promise(function(t){Notification.requestPermission(t)})}}().then(function(t){r="granted"===t})))}function l(t,e){if(r)try{return function(){try{var t=new Audio(f),e=t.play();e&&e.catch(m)}catch(t){}}(),new Notification(t,e)}catch(t){return}}function u(t){var e=document.querySelector("link[rel*='icon']");e||((e=document.createElement("link")).rel="shortcut icon"),e.href=t,document.getElementsByTagName("head")[0].appendChild(e)}var d=document.title;function h(t){document.title=t+d}var p,f=window.ServerData.assetURLPrefix+"/assets/notification.mp3";function m(){try{var t=new(window.AudioContext||window.webkitAudioContext);if(p){var e=t.createBufferSource();return e.buffer=p,e.connect(t.destination),void e.start()}fetch(f).then(function(t){return t.arrayBuffer()}).then(function(e){return new Promise(function(o){return t.decodeAudioData(e,o)})}).then(function(t){p=t,m()}).catch(function(t){return console.error(t)})}catch(t){console.error(t)}}},365:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(2),a=o(338),s=o(341),c=o(342),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),e.prototype.bindDomEvents=function(){t.prototype.bindDomEvents.call(this),this.leaveText=this.root.closest("[data-leave-text]").dataset.leaveText,this.influencerText=this.root.closest("[data-influencer-text]").dataset.influencerText},Object.defineProperty(e.prototype,"events",{get:function(){return["click/@root/onClick"]},enumerable:!0,configurable:!0}),e.prototype.onClick=function(t){var e=this;if(!this.locked){this.locked=!0;var o=function(t){return e.locked=!1};this.leave().then(o,o)}},e.prototype.checkFanClub=function(t){return Object(a.e)(t).then(function(t){return t.influencerInfo})},e.prototype.leave=function(){var t=this,e=this.getTarget().ndcId;return Promise.all([this.app.confirm(this.leaveText),this.checkFanClub(e)]).then(function(e){e[0];var o=e[1];return new Promise(function(e,n){o?setTimeout(function(){t.app.confirm(t.influencerText).then(e,n)},500):e()})}).then(function(t){return Object(a.f)(e)}).then(function(o){return t.afterStory(e)}).then(function(e){return Object(r.p)(t.dataset.href)}).catch(this.app.globalCatcher).catch(this.app.toastErrorHandler())},e.prototype.afterStory=function(t){return Object(s.g)(t),Object(c.removeCommunityFromHTMLCache)(t),collectTEA("leaves_community",{source:"Top Nav Popup"}),this.app.sendGaAndWait({eventCategory:"Leave"})},e.prototype.getTarget=function(){return Object(r.c)(this.dataset,"target")},e}(i.a);e.default=l},366:function(t,e,o){"use strict";o.r(e);var n=o(0),i=o(3),r=o(118),a=o(119),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.b(e,t),e.prototype.init=function(){var e=this;t.prototype.init.call(this),this.root.classList.remove("cloak"),this.on("open",function(t){return e.initPopper()})},e.prototype.bindDomEvents=function(){t.prototype.bindDomEvents.call(this),this.dataset.menuWidth&&(this.qs("ul.menu").style.width=this.dataset.menuWidth+"px")},Object.defineProperty(e.prototype,"events",{get:function(){return["click/@root/onClick"]},enumerable:!0,configurable:!0}),e.prototype.onClick=function(t){t.preventDefault(),t.target.closest(".menu")||this.doToggle()},e.prototype.initPopper=function(){this.popper&&this.popper.destroy();var t=this.root.closest(this.dataset.boundaryParent)||"scrollParent";this.popper=new a.a(this.root,this.qs("ul.menu"),{placement:"bottom-end",modifiers:{preventOverflow:{boundariesElement:t}}}),this.popper.scheduleUpdate()},e}(Object(r.b)(i.a));e.default=s},396:function(t,e,o){var n={"./action-menu":366,"./action-menu.ts":366,"./btn-leave-community":365,"./btn-leave-community.ts":365,"./chat-btn":363,"./chat-btn.ts":363,"./chat-window":362,"./chat-window.ts":362,"./compose-entry":360,"./compose-entry.ts":360,"./filter-amino":358,"./filter-amino.ts":358,"./follow-btn":357,"./follow-btn.ts":357,"./global-chat-communities":342,"./global-chat-communities.ts":342,"./global-chat-name":356,"./global-chat-name.ts":356,"./join-thread-btn":355,"./join-thread-btn.ts":355,"./poll-body":354,"./poll-body.ts":354,"./post-actions":353,"./post-actions.ts":353,"./sidebar-thread-card":352,"./sidebar-thread-card.ts":352,"./user-identity":351,"./user-identity.ts":351,"./user-logout":350,"./user-logout.ts":350,"./vote-poll":349,"./vote-poll.ts":349};function i(t){var e=r(t);return o(e)}function r(t){var e=n[t];if(!(e+1)){var o=new Error('Cannot find module "'+t+'".');throw o.code="MODULE_NOT_FOUND",o}return e}i.keys=function(){return Object.keys(n)},i.resolve=r,t.exports=i,i.id=396},398:function(t,e,o){},9:function(t,e,o){"use strict";function n(t){return t.replace("x","")}function i(t,e){var o=function(o){for(var n=o.target;n;){if(n===t)return;n=n.parentNode}e(o)};return document.body.addEventListener("click",o),function(){document.body.removeEventListener("click",o)}}function r(t,e){e=e||function(t){return t};var o=Object.assign({hitType:"event",hitCallback:e,eventAction:"Click",eventLabel:ServerData.eventLabel},t);"undefined"==typeof ga?(console.error("ga unavailable",o),e()):(ga("send",o),ga("sampling.send",o),navigator.sendBeacon&&setTimeout(e))}o.d(e,"b",function(){return n}),o.d(e,"a",function(){return i}),o.d(e,"c",function(){return r})}}]);